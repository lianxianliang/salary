<!DOCTYPE html>
<html lang="zh">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title></title>
		<style type="text/css">
			html,
			body {
				width: 100%;
				height: 100%;
				margin: 0;
				padding: 0;
				display: flex;
				align-items: center;
			}

			#main {
				width: 100%;
				height: 75vh;
			}
		</style>
	</head>
	<body>
		<div id="main"></div>

		<script src="echarts.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			let obj = {
				'京东': 14600,
				'电脑': 8899,
				'家里': 10000,
				'2018-04-16我机票退去伊宁': 1459,
				'2018-04-20我机票1去伊宁': 1960,
				'2018-04-20我机票2飞机延误去伊宁': 880,
				'2018-04-23我机票回广州': 1335,
				'2018-07-28我们桂林璃江': 420,
				'2019-02-28她机票去伊宁': 1349,
				'2019-05-01我机票去伊宁': 1759,
				'2019-05-05我机票回广州': 1589,
				'我们伊宁公寓': 952,
				'2019-11-16她机票回广州': 1920,
				'吃饭': 1040*35,
				'房租': 36*800,
			}

			var res = 0;
			Object.keys(obj).forEach(key => {
				res += obj[key];
			})
			console.log('总额：' + res);

			let count = 0;
			let xAxisData = [];
			let seriesData = [];
			let markPointData = [];

			let arrDate = [];
			Object.keys(obj).forEach((key, idx) => {
				count += obj[key];
				xAxisData.push(key);
				seriesData.push(obj[key]);
				markPointData.push({
					coord: [idx, obj[key]],
					value: obj[key],
					symbolSize: 85
				});
				arrDate.push(key);
			})

			let startDate = +new Date(arrDate[0]);
			let endDate = +new Date(arrDate[arrDate.length - 1]);
			let days = (endDate - startDate) / (1 * 24 * 60 * 60 * 1000);
			let average = (count / days).toFixed(2);
			let subtext = days + ' 天，每天 ' + average;

			var myChart = echarts.init(document.getElementById('main'));
			var option = {
				grid: {
					top: 100,
					left: '5%',
					right: '5%'
				},
				title: {
					left: 'center',
					text: count.toFixed(2),
					subtext
				},
				tooltip: {
					show: true,
					trigger: "axis"
				},
				xAxis: {
					type: 'category',
					axisLabel: {
						rotate: 45
					},
					boundaryGap: false,
					data: xAxisData
				},
				yAxis: {
					type: 'value'
				},
				series: [{
					data: seriesData,
					type: 'line',
					markLine: {
						data: [{
							name: '平均线',
							type: 'average'
						}],
						lineStyle: {
							color: 'rgba(255, 0, 0, 0.7)'
						}
					},
					markPoint: { // markLine 也是同理
						data: markPointData,
						itemStyle: {
							color: 'rgba(64, 158, 255, 0.5)'
						}
					}
				}]
			};

			myChart.setOption(option);

			window.onresize = function() {
				myChart.resize();
			}
		</script>
	</body>
</html>
